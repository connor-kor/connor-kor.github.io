---
title: 강의19
category: fullstack-class
---

# 12.22

get 방식 -> 서블릿 -> 포워딩

post 방식 -> 서블릿 -> 포워딩

ex01.jsp Ex01.java

입력	?파라미터 request.getAttribute(결과물)

​	로직처리

​	request.setAttribute (결과물)



게시판: webapp 에 board 와 member 폴더를 만든다.



```javascript
$("form:last-of-type :button").on("click", function(event) {
    $(this).parents("form").submit();
});
```



**java**

```java
String location = "/days03/ex01_ok.jsp";
response.sendRedirect(location);
```

servlet 을 수정 후에는 서버를 재실행해야된다.



12/22 오전수업 다시듣기





각 부서원들을 테이블 형식으로 출력.

ex03.jsp -> 서블릿

**[JSTL]**

JSTL: Java Standard Tag Library 

복습: 프로젝트 생성 정리

파일받는 사이트: https://mvnrepository.com/

JSTL 검색 - 제일 많이 사용한 것 - 제일 많이 사용한 버전 - **Files** jars 받기

```jsp
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
```

jar 를 uri WEB-INF - lib 에 추가하고 uri 를 자동완성한다.

prefix 에 c 를 넣는다.

템플릿에 추가할 것

getAttribute 가 필요없이 바로 사용할 수 있다.

- `c:if` 



**JSTL: 부서테이블 예시**

```jsp
<%@page import="java.util.Iterator"%>
<%@page import="java.util.ArrayList"%>
<%@page import="days02.EmpDTO"%>
<%@page import="java.sql.PreparedStatement"%>
<%@page import="com.util.DBConn"%>
<%@page import="java.sql.*"%>
<%@ page contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%
String pdeptno = request.getParameter("deptno");

String sql = "SELECT * ";
sql += "FROM emp ";
sql += "WHERE deptno = ? ";
sql += "ORDER BY ename ASC";
//
Connection conn = DBConn.getConnection();

PreparedStatement pstmt = null;
ResultSet rs = null;

int empno;
String ename;
String job;
int mgr;
Date hiredate; // String -> java.sql.Date
double sal;
double comm;
int deptno;

EmpDTO dto = null;

ArrayList<EmpDTO> list = null;
try {
	pstmt = conn.prepareStatement(sql);
	pstmt.setInt(1, Integer.parseInt(pdeptno)); // ?
	rs = pstmt.executeQuery();

	if (rs.next()) {
		list = new ArrayList<>();
		do {

	empno = rs.getInt("empno");
	ename = rs.getString("ename");
	job = rs.getString("job");
	mgr = rs.getInt("mgr");
	// java.sql.Date
	hiredate = rs.getDate("hiredate"); // rs.getString("hiredate")
	sal = rs.getDouble("sal");
	comm = rs.getDouble("comm");
	deptno = rs.getInt("deptno");

	dto = new EmpDTO(empno, ename, job, mgr, hiredate, sal, comm, deptno);

	list.add(dto);
		} while (rs.next());
	} // if

	pstmt.close();
	rs.close(); // ***
} catch (SQLException e) {
	e.printStackTrace();
}

DBConn.close();

// list
request.setAttribute("elist", list);
%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<style>
</style>
<title>Insert title here</title>
</head>
<body>
	<%
	// list = (ArrayList<EmpDTO>) request.getAttribute("list");
	%>

	<h3>ex03_jstl.jsp</h3>
	<a href="ex03_jstl.jsp?deptno=30">ex03_jstl.jsp</a>
	<br />

	<table border="1" style="width: 100%">
		<thead>
			<tr>
				<th>deptno</th>
				<th>empno</th>
				<th>ename</th>
				<th>job</th>
				<th>hiredate</th>
			</tr>
		</thead>
		<tbody>
			<c:if test="${not empty elist }">
				<c:forEach items="${elist }" var="dto">
					<tr>
						<td>${dto.deptno}</td>
						<td>${dto.empno}</td>
						<td>${dto.ename}</td>
						<td>${dto.job}</td>
						<td>${dto.hiredate}</td>
					<tr>
				</c:forEach>
			</c:if>
			<c:if test="${empty elist }">
				<tr>
					<td colspan="5" style="height:200px;">사원이 존재하지 않습니다.</td>
				</tr>
			</c:if>
		</tbody>
		<tfoot>
			<tr>
				<td colspan="5">${param.deptno }번 부서원은 ${elist.size() }명입니다.</td>
			</tr>
		</tfoot>
	</table>

	<a href="<%=request.getContextPath()%>/scott/dept">다시하기</a>
	

	<script>
		
	</script></
			body>
</html>
```



**[어제 팀과제]**

test00.html 링크 클릭 -> 서블릿 (Test00.java) urlpattern = "/days03.test00.html"

> 서블릿 후에는 항상 서버 재실행할 것!!

**포워딩**

```java
request.getRequestDispatcher("ex04_test00.jsp").forward(request, response);
```

> java 폴더와 webapp 폴더는 맞추는게 좋다.
>
> 확장자를 꼭 붙여야 한다.

dispacher: 전달자. 

`요청.요청전달자.포워드` 



복습: ex04 

- select option
- `c:if`
- `c:forEach` 





**[ex05]**

/jspPro/days03/ex05.html -> 서블릿 -> ex05.jsp

```jsp
<%@page import="java.util.Set"%>
<%@page import="java.util.Map.Entry"%>
<%@page import="java.util.Iterator"%>
<%@page import="days02.EmpDTO"%>
<%@page import="java.util.ArrayList"%>
<%@page import="days03.SalgradeDTO"%>
<%@page import="java.util.LinkedHashMap"%>
<%@ page contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<link rel="stylesheet"
	href="//code.jquery.com/ui/1.13.0/themes/base/jquery-ui.css">
<link rel="stylesheet" href="/resources/demos/style.css">
<script src="https://code.jquery.com/jquery-3.6.0.js"></script>
<script src="https://code.jquery.com/ui/1.13.0/jquery-ui.js"></script>
<script>
	$(function() {
		$("#accordion").accordion();
	});
</script>
<style>
</style>
<title>Insert title here</title>
</head>
<body>
	<h3>ex05.jsp</h3>
	
	<%
	LinkedHashMap<SalgradeDTO, ArrayList<EmpDTO>> map
	= (LinkedHashMap<SalgradeDTO,ArrayList<EmpDTO>>) request.getAttribute("map");
	%>
	
	

	<div id="accordion">
	
	<%
	Set<Entry<SalgradeDTO, ArrayList<EmpDTO>>> set = map.entrySet();
	Iterator<Entry<SalgradeDTO, ArrayList<EmpDTO>>> ir = set.iterator();

	while (ir.hasNext()) {
		Entry<SalgradeDTO, ArrayList<days02.EmpDTO>> entry = ir.next();
		SalgradeDTO dto = entry.getKey();
	%>
	<h3><%= String.format("%d등급   (    %d~%d ) - %d명", dto.getGrade(), dto.getLosal(), dto.getHisal(),
			dto.getCnt()) %></h3>
			<div>
	<%

		ArrayList<EmpDTO> empList = entry.getValue();
		Iterator<EmpDTO> e_ir = empList.iterator();

		while (e_ir.hasNext()) {
			EmpDTO edto = e_ir.next();
	%>
	<p>
		<%=String.format("\t%d\t%s\t%d\t%s\t%.2f\n", edto.getDeptno(), "", edto.getEmpno(), edto.getEname(),
				edto.getSal()) %>
	</p>
	<%
		} //
	%>
	</div>
	<%
	} // while
	%>
	
<!-- 		<h3>Section 1</h3> -->
<!-- 		<div> -->
<!-- 			<p>Mauris mauris ante, blandit et, ultrices a, suscipit eget, -->
<!-- 				quam. Integer ut neque. Vivamus nisi metus, molestie vel, gravida -->
<!-- 				in, condimentum sit amet, nunc. Nam a nibh. Donec suscipit eros. Nam -->
<!-- 				mi. Proin viverra leo ut odio. Curabitur malesuada. Vestibulum a -->
<!-- 				velit eu ante scelerisque vulputate.</p> -->
<!-- 		</div> -->
	</div>


	<script>
		
	</script>
</body>
</html>
```

